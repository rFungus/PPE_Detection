# ะะตะทัะปััะฐัั ะฟะพัะปะต ะทะฐะฒะตััะตะฝะธั pipeline

ะะพัะปะต ััะฟะตัะฝะพะณะพ ะฒัะฟะพะปะฝะตะฝะธั `python run_full_pipeline.py` ะฑัะดัั ัะพะทะดะฐะฝั ัะปะตะดัััะธะต ัะตะทัะปััะฐัั:

## ๐ ะกัััะบัััะฐ ัะพะทะดะฐะฝะฝัั ัะฐะนะปะพะฒ ะธ ะฟะฐะฟะพะบ

```
hahaton123/
โโโ ๐ config/
โ   โโโ ppe_data.yaml                    # โ ะะพะฝัะธะณััะฐัะธั ะดะฐัะฐัะตัะฐ (ัะพะทะดะฐะตััั ะฐะฒัะพะผะฐัะธัะตัะบะธ)
โ
โโโ ๐ data/
โ   โโโ ๐ images/
โ   โ   โโโ ๐ train/                   # โ ะะทะพะฑัะฐะถะตะฝะธั ะดะปั ะพะฑััะตะฝะธั (80%)
โ   โ   โ   โโโ video1_frame_000000.jpg
โ   โ   โ   โโโ video1_frame_000015.jpg
โ   โ   โ   โโโ ...
โ   โ   โโโ ๐ val/                      # โ ะะทะพะฑัะฐะถะตะฝะธั ะดะปั ะฒะฐะปะธะดะฐัะธะธ (20%)
โ   โ       โโโ video1_frame_000100.jpg
โ   โ       โโโ ...
โ   โโโ ๐ labels/
โ       โโโ ๐ train/                    # โ ะะฐะทะผะตัะบะฐ ะดะปั ะพะฑััะตะฝะธั
โ       โ   โโโ video1_frame_000000.txt
โ       โ   โโโ ...
โ       โโโ ๐ val/                       # โ ะะฐะทะผะตัะบะฐ ะดะปั ะฒะฐะปะธะดะฐัะธะธ
โ           โโโ ...
โ
โโโ ๐ models/
โ   โโโ ๐ ppe_detection_obb/            # โ ะะธัะตะบัะพัะธั ัะบัะฟะตัะธะผะตะฝัะฐ
โ       โโโ ๐ weights/
โ       โ   โโโ best.pt                   # โญ ะะฃะงะจะะฏ ะะะะะะฌ (ะธัะฟะพะปัะทัะนัะต ััั!)
โ       โ   โโโ last.pt                   # ะะพัะปะตะดะฝัั ะผะพะดะตะปั
โ       โโโ ๐ train_batch*.jpg           # ะัะธะผะตัั ะฑะฐััะตะน ะฒะพ ะฒัะตะผั ะพะฑััะตะฝะธั
โ       โโโ ๐ val_batch*.jpg             # ะัะธะผะตัั ะฒะฐะปะธะดะฐัะธะพะฝะฝัั ะฑะฐััะตะน
โ       โโโ results.png                   # ๐ ะัะฐัะธะบ ะผะตััะธะบ ะพะฑััะตะฝะธั
โ       โโโ results.csv                   # ๐ ะะตัะฐะปัะฝัะต ะผะตััะธะบะธ ะฟะพ ัะฟะพัะฐะผ
โ       โโโ confusion_matrix.png          # ๐ ะะฐััะธัะฐ ะพัะธะฑะพะบ
โ       โโโ F1_curve.png                  # ๐ F1 ะบัะธะฒะฐั
โ       โโโ PR_curve.png                  # ๐ Precision-Recall ะบัะธะฒะฐั
โ       โโโ args.yaml                     # ะะฐัะฐะผะตััั ะพะฑััะตะฝะธั
โ       โโโ events.out.tfevents.*        # TensorBoard ะปะพะณะธ (ะตัะปะธ ะฒะบะปััะตะฝ)
โ
โโโ ๐ output/
โ   โโโ ๐ detections/                   # โ ะะตะทัะปััะฐัั ัะตััะพะฒะพะน ะดะตัะตะบัะธะธ
โ   โ   โโโ [ะธะผั_ัะตััะพะฒะพะณะพ_ะธะทะพะฑัะฐะถะตะฝะธั].jpg  # ะะทะพะฑัะฐะถะตะฝะธะต ั ะฝะฐัะธัะพะฒะฐะฝะฝัะผะธ bounding boxes
โ   โโโ ๐ videos/                        # (ะตัะปะธ ะพะฑัะฐะฑะฐััะฒะฐะปะธ ะฒะธะดะตะพ)
โ
โโโ ๐ logs/
โ   โโโ pipeline_YYYYMMDD_HHMMSS.log      # โ ะะพะปะฝัะน ะปะพะณ ะฒัะฟะพะปะฝะตะฝะธั pipeline
โ
โโโ ๐ models/logs/                      # ะะพะณะธ ะพะฑััะตะฝะธั
    โโโ ppe_detection_YYYYMMDD_HHMMSS.log
```

## โญ ะะปะฐะฒะฝัะต ัะตะทัะปััะฐัั

### 1. **ะะฑััะตะฝะฝะฐั ะผะพะดะตะปั** (ัะฐะผะพะต ะฒะฐะถะฝะพะต!)

**ะััั:** `models/ppe_detection_obb/weights/best.pt`

- ะญัะพ ะปัััะฐั ะผะพะดะตะปั ะฟะพ ะผะตััะธะบะต mAP50
- ะัะฟะพะปัะทัะนัะต ะตั ะดะปั ะดะตัะตะบัะธะธ ะฝะฐ ะฝะพะฒัั ะธะทะพะฑัะฐะถะตะฝะธัั

**ะะปััะตัะฝะฐัะธะฒะฐ:** `models/ppe_detection_obb/weights/last.pt`
- ะะพัะปะตะดะฝัั ะผะพะดะตะปั ะฟะพัะปะต ะฒัะตั ัะฟะพั
- ะะพะถะตั ะฑััั ััะถะต ัะตะผ best.pt

### 2. **ะะตััะธะบะธ ะพะฑััะตะฝะธั**

**ะคะฐะนะป:** `models/ppe_detection_obb/results.csv`

ะกะพะดะตัะถะธั ะผะตััะธะบะธ ะฟะพ ะบะฐะถะดะพะน ัะฟะพัะต:
- `metrics/mAP50(B)` - ััะตะดะฝัั ัะพัะฝะพััั ะฟัะธ IoU=0.5
- `metrics/mAP50-95(B)` - ััะตะดะฝัั ัะพัะฝะพััั ะฟัะธ IoU=0.5-0.95
- `metrics/precision(B)` - ัะพัะฝะพััั
- `metrics/recall(B)` - ะฟะพะปะฝะพัะฐ
- `train/box_loss` - loss ะดะปั bounding boxes
- `train/cls_loss` - loss ะดะปั ะบะปะฐััะธัะธะบะฐัะธะธ
- ะ ะดััะณะธะต ะผะตััะธะบะธ

**ะัะฐัะธะบะธ:** `models/ppe_detection_obb/results.png`
- ะะธะทัะฐะปะธะทะฐัะธั ะฒัะตั ะผะตััะธะบ ะฒ ะฒะธะดะต ะณัะฐัะธะบะพะฒ
- ะะพะบะฐะทัะฒะฐะตั ะฟัะพะณัะตัั ะพะฑััะตะฝะธั

### 3. **ะขะตััะพะฒะฐั ะดะตัะตะบัะธั**

**ะะฐะฟะบะฐ:** `output/detections/`

- ะัะธะผะตั ะดะตัะตะบัะธะธ ะฝะฐ ะพะดะฝะพะผ ะธะทะพะฑัะฐะถะตะฝะธะธ ะธะท ะฒะฐะปะธะดะฐัะธะธ
- ะะพะบะฐะทัะฒะฐะตั, ะบะฐะบ ะผะพะดะตะปั ัะฐะฑะพัะฐะตั ะฝะฐ ัะตะฐะปัะฝัั ะดะฐะฝะฝัั
- ะะทะพะฑัะฐะถะตะฝะธะต ั ะฝะฐัะธัะพะฒะฐะฝะฝัะผะธ bounding boxes

## ๐ ะะฐะบ ะฟัะพะฒะตัะธัั ะบะฐัะตััะฒะพ ะผะพะดะตะปะธ

### 1. ะะพัะผะพััะตัั ะผะตััะธะบะธ ะฒ CSV

```python
import pandas as pd

df = pd.read_csv("models/ppe_detection_obb/results.csv")
print(df[['metrics/mAP50(B)', 'metrics/mAP50-95(B)']].tail())
```

### 2. ะะพัะผะพััะตัั ะณัะฐัะธะบะธ

ะัะบัะพะนัะต `models/ppe_detection_obb/results.png` - ัะฐะผ ะฑัะดัั ะณัะฐัะธะบะธ:
- ะะตััะธะบะธ ะดะพะปะถะฝั ัะฐััะธ (ะธะปะธ ััะฐะฑะธะปะธะทะธัะพะฒะฐัััั)
- Loss ะดะพะปะถะตะฝ ัะผะตะฝััะฐัััั

### 3. ะัะพัะตััะธัะพะฒะฐัั ะฝะฐ ัะฒะพะธั ะธะทะพะฑัะฐะถะตะฝะธัั

```python
from src.inference.detect_utils import PPEDetector

# ะะฐะณััะถะฐะตะผ ะปััััั ะผะพะดะตะปั
detector = PPEDetector("models/ppe_detection_obb/weights/best.pt")

# ะขะตััะธััะตะผ ะฝะฐ ะธะทะพะฑัะฐะถะตะฝะธะธ
result_img, detections = detector.detect_image(
    "ะฟััั/ะบ/ะธะทะพะฑัะฐะถะตะฝะธั.jpg",
    save_result=True
)

print(f"ะะฐะนะดะตะฝะพ ะดะตัะตะบัะธะน: {len(detections)}")
for det in detections:
    print(f"  {det['class_name']}: {det['confidence']:.2f}")
```

## ๐ฏ ะงัะพ ะผะพะถะฝะพ ะดะตะปะฐัั ะดะฐะปััะต

### 1. ะัะฟะพะปัะทะพะฒะฐัั ะผะพะดะตะปั ะดะปั ะดะตัะตะบัะธะธ

**ะงะตัะตะท ัะบัะธะฟั:**
```bash
python detect.py --model models/ppe_detection_obb/weights/best.pt --source image.jpg
```

**ะงะตัะตะท Python:**
```python
from src.inference.detect_utils import PPEDetector

detector = PPEDetector("models/ppe_detection_obb/weights/best.pt")

# ะะฐ ะธะทะพะฑัะฐะถะตะฝะธะธ
result_img, detections = detector.detect_image("image.jpg", save_result=True)

# ะะฐ ะฒะธะดะตะพ
detector.detect_video("video.mp4", output_path="output/detected.mp4")

# ะก ะบะฐะผะตัั (ัะตะฐะปัะฝะพะต ะฒัะตะผั)
detector.detect_camera(camera_id=0)
```

### 2. ะฃะปัััะธัั ะผะพะดะตะปั (ะตัะปะธ ะฝัะถะฝะพ)

ะัะปะธ ะผะตััะธะบะธ ะฝะธะทะบะธะต:
- ะะพะฑะฐะฒััะต ะฑะพะปััะต ะดะฐะฝะฝัั
- ะัะพะฒะตัััะต ะบะฐัะตััะฒะพ ัะฐะทะผะตัะบะธ
- ะฃะฒะตะปะธัััะต ะบะพะปะธัะตััะฒะพ ัะฟะพั
- ะะพะฟัะพะฑัะนัะต ะดััะณัั ะผะพะดะตะปั (yolov8m.pt, yolov8x.pt)

### 3. ะัะพะฒะตัะธัั ัะฐะทะผะตัะบั ะดะฐะฝะฝัั

```bash
# ะัะพะฒะตัะบะฐ ััััะบัััั ะดะฐะฝะฝัั
python check.py

# ะัะพะฒะตัะบะฐ ัะพัะผะฐัะฐ OBB ะฐะฝะฝะพัะฐัะธะน
python check.py --obb
```

## ๐ ะขะธะฟะธัะฝัะต ัะตะทัะปััะฐัั

ะะพัะปะต 30 ัะฟะพั ะพะฑััะตะฝะธั ั ะพะฟัะธะผะธะทะธัะพะฒะฐะฝะฝัะผะธ ะฟะฐัะฐะผะตััะฐะผะธ:

**ะะถะธะดะฐะตะผัะต ะผะตััะธะบะธ:**
- mAP50: 0.5 - 0.8 (ะทะฐะฒะธัะธั ะพั ะบะฐัะตััะฒะฐ ะดะฐะฝะฝัั)
- mAP50-95: 0.3 - 0.6
- ะัะตะผั ะพะฑััะตะฝะธั: 1-2 ัะฐัะฐ (ะฝะฐ GPU)

**ะัะปะธ ะผะตััะธะบะธ ะฝะธะทะบะธะต (< 0.3):**
- ะัะพะฒะตัััะต ะบะฐัะตััะฒะพ ัะฐะทะผะตัะบะธ
- ะฃะฑะตะดะธัะตัั, ััะพ ะดะพััะฐัะพัะฝะพ ะดะฐะฝะฝัั (ะผะธะฝะธะผัะผ 100-200 ะธะทะพะฑัะฐะถะตะฝะธะน ะฝะฐ ะบะปะฐัั)
- ะะพะฟัะพะฑัะนัะต ัะฒะตะปะธัะธัั ะบะพะปะธัะตััะฒะพ ัะฟะพั ะดะพ 50-100

## ๐ ะัะพะฒะตัะบะฐ ัะตะทัะปััะฐัะพะฒ

### ะััััะฐั ะฟัะพะฒะตัะบะฐ:

1. **ะะพะดะตะปั ัััะตััะฒัะตั?**
   ```bash
   ls models/ppe_detection_obb/weights/best.pt
   ```

2. **ะะตััะธะบะธ ะตััั?**
   ```bash
   ls models/ppe_detection_obb/results.csv
   ```

3. **ะัะฐัะธะบะธ ัะพะทะดะฐะฝั?**
   ```bash
   ls models/ppe_detection_obb/results.png
   ```

4. **ะขะตััะพะฒะฐั ะดะตัะตะบัะธั ัะฐะฑะพัะฐะตั?**
   ```bash
   ls output/detections/
   ```

## โ๏ธ ะะฐะถะฝัะต ัะฐะนะปั

**ะะฑัะทะฐัะตะปัะฝะพ ัะพััะฐะฝะธัะต:**
- โ `models/ppe_detection_obb/weights/best.pt` - ะปัััะฐั ะผะพะดะตะปั
- โ `models/ppe_detection_obb/results.csv` - ะผะตััะธะบะธ
- โ `config/ppe_data.yaml` - ะบะพะฝัะธะณััะฐัะธั ะดะฐัะฐัะตัะฐ

**ะะพะถะฝะพ ัะดะฐะปะธัั (ะดะปั ัะบะพะฝะพะผะธะธ ะผะตััะฐ):**
- `models/ppe_detection_obb/weights/last.pt` - ะตัะปะธ best.pt ะดะพััะฐัะพัะฝะพ
- `models/ppe_detection_obb/train_batch*.jpg` - ะฟัะธะผะตัั ะฑะฐััะตะน
- `logs/` - ััะฐััะต ะปะพะณะธ (ะตัะปะธ ะฝะต ะฝัะถะฝั)

## ๐ ะะพะณะธ

ะัะต ะดะตะนััะฒะธั ะปะพะณะธัััััั ะฒ:
- `logs/pipeline_YYYYMMDD_HHMMSS.log` - ะฟะพะปะฝัะน ะปะพะณ pipeline
- `models/ppe_detection_obb/logs/` - ะปะพะณะธ ะพะฑััะตะฝะธั

ะ ะปะพะณะฐั ะผะพะถะฝะพ ะฝะฐะนัะธ:
- ะัะต ะฒัะฟะพะปะฝะตะฝะฝัะต ััะฐะฟั
- ะะตััะธะบะธ ะพะฑััะตะฝะธั
- ะัะธะฑะบะธ (ะตัะปะธ ะฑัะปะธ)
- ะัะตะผั ะฒัะฟะพะปะฝะตะฝะธั ะบะฐะถะดะพะณะพ ััะฐะฟะฐ

